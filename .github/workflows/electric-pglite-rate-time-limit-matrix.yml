name: 'PGlite + Generated API Time and Rate-Limit Matrix'

on:
  workflow_dispatch:
  schedule:
    - cron:  '0 0 * * *'

jobs:
  electric-pglite-single-txn-rate-time-limit-matrix:
    strategy:
      matrix:
        rate: [10 50 100]
        time-limit: [60 300 600 3600]
    uses: nurturenature/jepsen-causal-consistency/.github/workflows/ad-hoc-jepsen-test.yml@main
    with:
      test_name: PGlite + Generated API at ${{ matrix.rate }}tps for ${{ matrix.time-limit }}s
      jepsen_cli: lein run test --workload electric-pglite-strong --rate ${{ matrix.rate }} --time-limit ${{ matrix.time-limit }}

